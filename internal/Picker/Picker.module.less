// Picker.module.less
//
@import "../../styles/variables.less";
@import "../../styles/mixins.less";
@import "../../styles/skin.less";

.picker {
	display: inline-block;
	vertical-align: bottom;
	position: relative;
	text-align: center;
	margin-left: @sand-spotlight-outset;
	margin-right: @sand-spotlight-outset;

	.sizingPlaceholder,
	.valueWrapper {
		.sand-text-base();
		.sand-locale-non-latin({line-height: @sand-button-small-height;});
		max-width: 960px;
	}

	.sizingPlaceholder {
		height: 0;
		visibility: hidden;
	}

	.valueWrapper {
		overflow: hidden;
		margin-left: auto;
		margin-right: auto;
		vertical-align: bottom;
		height: @sand-picker-value-height;
		line-height: @sand-picker-value-height;
	}

	.incrementer,
	.decrementer {
		cursor: pointer;
		margin: 0;
		position: relative;
		transition: transform 100ms;

		.disabled({
			cursor: default;
		});
	}

	&.horizontal {
		display: inline-flex;

		:global(.enact-locale-right-to-left) & {
			flex-direction: row-reverse;
		}

		.incrementer {
			order: 3;
			flex-shrink: 0;
			margin-left: @sand-spotlight-outset;
		}
		.decrementer {
			order: 1;
			flex-shrink: 0;
			margin-right: @sand-spotlight-outset;
		}
		.valueWrapper {
			order: 2;
			position: relative;

			.item {
				transform: translateX(100%);
			}
		}

		&.small,
		&.medium,
		&.large {
			.valueWrapper {

				.item {
					position: absolute;
					.position(0);
					transform: translateX(100%);
				}
			}
		}
	}

	&.vertical {
		.valueWrapper {
			display: block;
			position: relative;
			line-height: @sand-picker-value-height;

			.sizingPlaceholder,
			.item {
				margin: 0 @sand-spotlight-outset;
			}

			.item {
				position: absolute;
				.position(0);
				transform: translateY(100%);
			}
		}
	}

	&.joined {
		@joined-arrow-transform-resting: scale(0.7);
		@joined-arrow-transform-focus: scale(0.95);
		@joined-arrow-transform-active: @joined-arrow-transform-resting;

		transition: filter @sand-picker-focus-duration ease-out;
		perspective: 480px;

		.bg {
			.sand-spotlight-resting();
			content: "";
			position: absolute;
			transition: transform 0.3s ease-out;
			.position(0);

			&::after {
				.position(0);
				content: "";
				display: block;
				position: absolute;
				border-width: 0;
				border-style: solid;
				border-radius: inherit;
				pointer-events: none;
			}
		}

		.icon {
			vertical-align: top;
			margin: 0;
			width: @sand-button-small-height;
			height: @sand-button-small-height;
			line-height: @sand-button-small-height;
		}

		.valueWrapper {
			height: @sand-picker-value-height;
			line-height: @sand-picker-value-height;
		}

		.incrementer,
		.decrementer {
			will-change: transform;
			transform: @joined-arrow-transform-resting;

			&.hidden {
				visibility: hidden;
			}
		}

		&.horizontal {
			height: @sand-picker-joined-horizontal-height;
			line-height: @sand-picker-joined-horizontal-height;

			.bg {
				border-radius: @sand-picker-joined-horizontal-border-radius;
			}

			.valueWrapper {
				height: @sand-picker-joined-horizontal-value-line-height;
				line-height: @sand-picker-joined-horizontal-value-line-height;
			}

			&.incrementing .bg {
				transform: rotateY(5deg);
				// transform-origin: left center;
			}
			&.incrementing .bg::after {
				border-right-width: @sand-integer-picker-shadow-width;
			}
			&.decrementing .bg {
				// transform-origin: right center;
				transform: rotateY(-5deg);
			}
			&.decrementing .bg::after {
				border-left-width: @sand-integer-picker-shadow-width;
			}
			.incrementer,
			.decrementer {
				margin: 0;
				height: @sand-picker-joined-horizontal-height;
				line-height: @sand-picker-joined-horizontal-height;

				.icon {
					visibility: hidden;
				}
			}

			.indicatorContainer {
				position: absolute;
				bottom: @sand-picker-indicator-bottom;
				left: 50%;
				transform: translateX(-50%);
				margin: 0 auto;
				line-height: 0;
				white-space: nowrap;

				.indicator {
					display: inline-block;
					width: @sand-picker-indicator-width;
					height: @sand-picker-indicator-height;
					margin: @sand-picker-indicator-margin;
					border-radius: @sand-picker-indicator-border-radius;
					transform: scale(@sand-picker-indicator-inactive-scale);
					vertical-align: middle;
					will-change: transform;
					transition: transform @sand-picker-focus-duration ease-out;

					&.active {
						transform: scale(@sand-picker-indicator-active-scale);
					}
				}
			}
		}

		&.vertical {
			.bg,
			.bg::after {
				border-radius: @sand-picker-joined-vertical-border-radius;
			}

			&.incrementing .bg {
				transform: rotateX(5deg);

				&::after {
					border-top-width: @sand-integer-picker-shadow-width;
				}
			}
			&.decrementing .bg {
				transform: rotateX(-5deg);

				&::after {
					border-bottom-width: @sand-integer-picker-shadow-width;
				}
			}
			.incrementer,
			.decrementer {
				display: block;
			}
		}

		.focus({
			.bg {
				.sand-spotlight-focus();
			}

			.incrementer,
			.decrementer {
				transform: @joined-arrow-transform-focus;
			}

			&.incrementing .incrementer,
			&.decrementing .decrementer {
				transform: @joined-arrow-transform-active;
			}

			.disabled({
				.incrementer,
				.decrementer {
					transform: @joined-arrow-transform-resting;
				}
			});
		});
	}

	&.small .valueWrapper {
		width: (@sand-icon-large-size + @sand-spotlight-outset*3);
	}
	&.medium .valueWrapper {
		width: @sand-picker-medium-value-width;
	}
	&.large .valueWrapper {
		width: @sand-picker-large-value-width;
	}

	// Skin colors
	.applySkins({
		.sizingPlaceholder,
		.valueWrapper {
			color: @sand-picker-text-color;
		}

		.valueWrapper {
			color: inherit;
		}

		&.joined {
			color: @sand-picker-joined-text-color;

			.bg {
				.sand-spotlight-resting-colors();

				&::after {
					border-color: @sand-picker-joined-fingernail-border-color;
				}
			}

			&.horizontal {
				.bg {
					background-color: @sand-picker-joined-horizontal-bg-color;
				}

				.indicator {
					background-color: @sand-picker-indicators-inactive-bg-color;

					&.active {
						background-color: @sand-picker-indicators-active-bg-color;
					}
				}
			}

			.focus({
				color: @sand-picker-focus-text-color;

				.bg {
					// background-color: @sand-picker-joined-bg-color;
					// filter: drop-shadow(@sand-picker-resting-shadow);
					.sand-spotlight-focus-colors();
				}

				.disabled({
					color: @sand-spotlight-disabled-text-color;
				});

				.indicator {
					background-color: @sand-picker-indicators-inactive-focus-bg-color;

					&.active {
						background-color: @sand-picker-indicators-active-focus-bg-color;
					}
				}
			})
		}
	});

	// Large-text mode rules
	.sand-custom-text({
		.sizingPlaceholder,
		.valueWrapper {
			font-size: @sand-item-font-size-large;
		}
		.valueWrapper {
			line-height: @sand-button-small-height-large;
			height: @sand-button-small-height-large;
		}

		&.joined {
			&.horizontal {
				font-size: @sand-item-font-size-large;
				height: @sand-button-small-height-large;
				line-height: @sand-button-small-height-large;

				.incrementer,
				.decrementer {
					&,
					.icon {
						height: @sand-button-small-height-large;
						line-height: @sand-button-small-height-large;
					}
				}
			}
		}

		&.small,
		&.medium,
		&.large {
			&.vertical {
				.valueWrapper {
					.sizingPlaceholder,
					.item {
						margin: 0 @sand-spotlight-outset;
					}
				}
			}
		}

		&.vertical {
			.valueWrapper {
				padding: 0 @sand-spotlight-outset;

				.sizingPlaceholder,
				.item {
					margin: 0;
				}
			}
		}
	});
}

.muted({
	.picker {
		.applySkins({
			&.joined {
				.focus({
					color: @sand-picker-joined-text-color;

					&.horizontal {
						.bg {
							background-color: @sand-picker-joined-horizontal-bg-color;
						}
					}

					.incrementer,
					.decrementer {
						transform: scale(0.7);
					}
				});
			}
		});
	}
});
